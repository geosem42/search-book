import{d as l,k as I,p as U,q,o as s,c as L,w as D,a as e,i as w,e as o,f as r,t as _,F as S,h as C,l as O,s as V}from"./app-973b6018.js";import{_ as z}from"./AppLayout-dfa019e6.js";import"./_plugin-vue_export-helper-c27b6911.js";const A=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Dashboard ",-1),H={class:"py-12"},P={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},X={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},Y=["onSubmit"],K={type:"submit",class:"relative flex items-center justify-center px-4 py-2 font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 min-w-[8rem] min-h-[2.5rem]"},G={key:0,class:"flex items-center justify-center"},J={key:1,class:"absolute inset-0 flex items-center justify-center"},Q=e("span",{class:"spinner"},null,-1),W=[Q],Z={key:0,class:"text-red-600 px-4"},ee={key:1,class:"mt-8"},te=e("h3",{class:"mb-4 text-lg font-medium text-blue-600 px-4"},"Your Documents",-1),se={key:0,class:"flex items-center justify-center p-4"},oe=e("span",{class:"spinner"},null,-1),ne=[oe],le={key:1,class:"w-full table-auto"},ae=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Name"),e("th",{class:"px-4 py-2 text-left"},"Actions")])],-1),re={class:"border px-4 py-2"},ie={class:"border px-4 py-2"},ce=["onClick"],ue=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"},null,-1),de=[ue],pe={key:2,class:"text-center my-8 text-gray-600"},fe={key:0,class:"fixed inset-0 z-10 flex items-center justify-center bg-black bg-opacity-50"},he={class:"bg-white rounded-lg p-4 relative w-3/4 h-3/4 overflow-y-auto"},me={class:"text-lg font-medium mb-2"},_e=["onSubmit"],ve=e("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md"},"Search",-1),xe={key:0,class:"text-center text-gray-600"},be={class:"divide-y divide-gray-200"},ye={class:"flex items-center justify-between"},ge={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"},we={class:"mt-2 sm:flex sm:justify-between"},ke={class:"sm:flex"},je=["innerHTML"],Ne={__name:"Dashboard",setup(De){const v=l(null),M=l(null),x=l(null),i=l(""),u=l([]),d=l([]),p=l(!1),c=l(!1),f=l(null),b=l(!1),y=l(!1),g=l(!1),h=l(""),F=t=>{v.value=t.target.files[0]},N=()=>{x.value&&(x.value.value="")},R=async()=>{try{if(v.value){p.value=!0;const t=new FormData;t.append("file",v.value);const m=(await(await fetch("/csrf-token")).json()).csrfToken,j=await(await fetch("/upload",{method:"POST",headers:{"X-CSRF-TOKEN":m},body:t})).json();j.success?(await k(),h.value=""):h.value=j.error}}catch(t){console.error(t)}finally{N(),M.value="",p.value=!1}},T=t=>{f.value=t,b.value=!0},$=()=>{i.value="",u.value=[],b.value=!1},B=async()=>{try{y.value=!0,g.value=!0;const n=await(await fetch(`/search?document=${f.value.id}&query=${encodeURIComponent(i.value)}`)).json();u.value=n.results}catch(t){console.error(t)}finally{g.value=!1}},E=I(()=>u.value.map(t=>{let n=t.snippet.substring(0,255);n="..."+n+"...";const a=new RegExp(`(${i.value.replace(/\s+/g,"\\s+")})`,"gi");return n=n.replace(a,'<span class="text-blue-600 font-bold">$1</span>'),{term:i.value,page:t.page,snippet:n}})),k=async()=>{c.value=!0;try{const n=await(await fetch("/documents")).json();d.value=n.documents}catch(t){console.error(t)}finally{c.value=!1}};return U(k),q(i,()=>{y.value=!1}),(t,n)=>(s(),L(z,{title:"Dashboard"},{header:D(()=>[A]),default:D(()=>[e("div",H,[e("div",P,[e("div",X,[e("form",{onSubmit:w(R,["prevent"]),class:"flex flex-row items-center p-4 bg-white rounded-md gap-3",enctype:"multipart/form-data"},[e("input",{class:"relative m-0 block w-full min-w-0 flex-auto rounded border border-solid border-neutral-300 bg-clip-padding px-3 py-[0.32rem] text-base font-normal text-neutral-700 transition duration-300 ease-in-out file:-mx-3 file:-my-[0.32rem] file:overflow-hidden file:rounded-none file:border-0 file:border-solid file:border-inherit file:bg-neutral-100 file:px-3 file:py-[0.32rem] file:text-neutral-700 file:transition file:duration-150 file:ease-in-out file:[border-inline-end-width:1px] file:[margin-inline-end:0.75rem] hover:file:bg-neutral-200",type:"file",id:"file",name:"file",accept:".pdf",ref_key:"fileInput",ref:x,onChange:F},null,544),e("button",K,[p.value?r("",!0):(s(),o("span",G,"Upload")),p.value?(s(),o("span",J,W)):r("",!0)])],40,Y),h.value?(s(),o("div",Z,_(h.value),1)):r("",!0),d.value.length>0?(s(),o("div",ee,[te,c.value?(s(),o("div",se,ne)):r("",!0),c.value?r("",!0):(s(),o("table",le,[ae,e("tbody",null,[(s(!0),o(S,null,C(d.value,a=>(s(),o("tr",{key:a.id},[e("td",re,_(a.original_name),1),e("td",ie,[(s(),o("svg",{onClick:w(m=>T(a),["prevent"]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 search"},de,8,ce))])]))),128))])]))])):r("",!0),!c.value&&d.value.length===0?(s(),o("div",pe," You don't have any files. ")):r("",!0)])])]),b.value&&f.value?(s(),o("div",fe,[e("div",he,[e("button",{class:"absolute top-2 right-2 text-gray-600",onClick:$},"X"),e("h3",me,_(f.value.original_name),1),e("form",{onSubmit:w(B,["prevent"]),class:"flex items-center mb-4"},[O(e("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=a=>i.value=a),class:"border border-gray-300 rounded-md px-2 py-1 mr-2"},null,512),[[V,i.value]]),ve],40,_e),y.value&&!g.value&&u.value.length===0?(s(),o("div",xe," No results found. ")):r("",!0),e("ul",be,[(s(!0),o(S,null,C(E.value,(a,m)=>(s(),o("li",{key:m,class:"px-4 py-4 sm:px-6"},[e("div",ye,[e("span",ge," Page "+_(a.page),1)]),e("div",we,[e("div",ke,[e("p",{class:"text-sm text-gray-500",innerHTML:a.snippet},null,8,je)])])]))),128))])])])):r("",!0)]),_:1}))}};export{Ne as default};
